<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clicker123</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÆ</text></svg>">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
            --tg-theme-hint-color: #999999;
            --tg-theme-link-color: #007bff;
            --tg-theme-button-color: #007bff;
            --tg-theme-button-text-color: #ffffff;
        }

        body {
            margin: 0;
            font-family: Arial, sans-serif;
            color: var(--tg-theme-text-color);
            background: var(--tg-theme-bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            font-size: 18px;
        }

        .content {
            flex: 1;
            padding: 20px;
            width: 100%;
            max-width: 600px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .tabs {
            display: flex;
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 600px;
            background: var(--tg-theme-bg-color);
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-top: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            border-top: 2px solid var(--tg-theme-button-color);
            background: #f5f5f5;
        }

        .image-button {
            width: 200px;
            height: 200px;
            border: none;
            background-image: url('https://gas-kvas.com/grafic/uploads/posts/2024-01/gas-kvas-com-p-znachok-bitkoina-na-prozrachnom-fone-15.png');
            background-size: cover;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .image-button:active {
            transform: scale(0.95);
        }

        .button {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
        }

        .energy-bar {
            width: 100%;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .energy-fill {
            height: 100%;
            background: var(--tg-theme-button-color);
            transition: width 0.3s;
        }

        #balance, #energy {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }

        .boost-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
    <div class="content" id="content1">
        <h1 id="balance">0</h1>
        <div id="energy">Energy: 100/100</div>
        <div class="energy-bar"><div class="energy-fill" id="energy-fill" style="width: 100%"></div></div>
        <button id="click" class="image-button"></button>
    </div>
    <div class="content" id="content2" style="display:none;">
        <h2>Boosts</h2>
        <div id="boosts">
            <div class="boost-item">
                <span>Click Power +1 (Level <span class="level-multiply-per-click">1</span>)</span>
                <button class="button boost-multiply-per-click">Buy (<span class="cost-multiply-per-click">100</span>)</button>
            </div>
            <div class="boost-item">
                <span>Energy Limit +100 (Level <span class="level-energy-limit">1</span>)</span>
                <button class="button boost-energy-limit">Buy (<span class="cost-energy-limit">200</span>)</button>
            </div>
            <div class="boost-item">
                <span>Faster Energy Recharge (Level <span class="level-recharge-energy">1</span>)</span>
                <button class="button boost-recharge-energy">Buy (<span class="cost-recharge-energy">150</span>)</button>
            </div>
            <div class="boost-item">
                <span>Passive Income Card 1 (Level <span class="level-passive-card1">0</span>)</span>
                <button class="button boost-passive-card1">Buy (<span class="cost-passive-card1">300</span>)</button>
            </div>
            <div class="boost-item">
                <span>Passive Income Card 2 (Level <span class="level-passive-card2">0</span>)</span>
                <button class="button boost-passive-card2">Buy (<span class="cost-passive-card2">500</span>)</button>
            </div>
            <div class="boost-item">
                <span>Passive Income Card 3 (Level <span class="level-passive-card3">0</span>)</span>
                <button class="button boost-passive-card3">Buy (<span class="cost-passive-card3">1000</span>)</button>
            </div>
        </div>
    </div>
    <div class="content" id="content3" style="display:none;">
        <h2>Friends</h2>
        <p>Invite friends to earn bonuses!</p>
        <button class="button invite-friend">Invite Friend</button>
    </div>

    <div class="tabs">
        <div class="tab active" data-tab="1">Click</div>
        <div class="tab" data-tab="2">Boost</div>
        <div class="tab" data-tab="3">Friends</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, setPersistence, inMemoryPersistence } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBhLISxR41ZYKyyffiY08c_YtqYQdu85pk",
            authDomain: "test-b5ec3.firebaseapp.com",
            databaseURL: "https://test-b5ec3-default-rtdb.firebaseio.com",
            projectId: "test-b5ec3",
            storageBucket: "test-b5ec3.appspot.com",
            messagingSenderId: "489032935342",
            appId: "1:489032935342:web:922e8c518ad0ff6b6eca3f",
            measurementId: "G-YNQM9CV4P3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        setPersistence(auth, inMemoryPersistence); // –û—Ç–∫–ª—é—á–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        const tg = window.Telegram.WebApp;
        tg.expand();

        let userId = tg.initDataUnsafe.user && tg.initDataUnsafe.user.id ? tg.initDataUnsafe.user.id : null;
        let balance = 0;
        let serverBalance = 0;
        let energy = 100;
        let maxEnergy = 100;
        let rechargeRate = 1;
        let clickPower = 1;
        let passiveIncome = { card1: 0, card2: 0, card3: 0 };
        let lastClickTime = 0;
        let lastLoginTime = 0;
        let lastEnergyUpdate = 0;
        let firstClickTime = 0; // –î–ª—è –¥–µ–ª—å—Ç–∞-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
        let clickBuffer = []; // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤
        const MIN_CLICK_INTERVAL = 100; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤
        const ENERGY_UPDATE_INTERVAL = 1000; // –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É
        const MAX_LOGINS_PER_HOUR = 10; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ö–æ–¥–æ–≤
        const MAX_CLICKS_PER_SECOND = 10; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤
        const BUFFER_FLUSH_INTERVAL = 1000; // –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª–∏–∫–æ–≤ —Ä–∞–∑ –≤ 1 —Å–µ–∫

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ pass1
        const urlParams = new URLSearchParams(window.location.search);
        const pass1 = urlParams.get("pass1");

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ userId –∏ pass1
        function initializeAppLogic() {
            if (!userId || !pass1) {
                alert("Error: Unable to get Telegram user ID or password");
                tg.close();
                return false;
            }
            return true;
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        if (initializeAppLogic()) {
            // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
            const email = userId + "@example.com";
            signInWithEmailAndPassword(auth, email, pass1)
                .then(function(userCredential) {
                    console.log("Auth successful for user: " + userId); // –û—Ç–ª–∞–¥–∫–∞
                    initializeUserData();
                    logLogin();
                })
                .catch(function(error) {
                    console.error("Authentication failed: " + error.message);
                    alert("Authentication failed: " + error.message);
                    tg.close();
                });
        }

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞
        function logLogin() {
            var now = Date.now();
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –≤—Ö–æ–¥–æ–≤
            onValue(ref(db, "users/" + userId + "/login_history"), function(snapshot) {
                if (snapshot.exists()) {
                    var logins = snapshot.val();
                    var hourAgo = now - 3600000;
                    var recentLogins = Object.keys(logins).filter(function(t) {
                        return parseInt(t) > hourAgo;
                    });
                    if (recentLogins.length >= MAX_LOGINS_PER_HOUR) {
                        console.error("Too many logins: " + recentLogins.length);
                        alert("Too many logins. Please try again later.");
                        tg.close();
                        return;
                    }
                }
                // –ó–∞–ø–∏—Å—å –≤—Ö–æ–¥–∞
                set(ref(db, "users/" + userId + "/login_history/" + now), 1)
                    .then(function() {
                        console.log("Login recorded: t=" + now); // –û—Ç–ª–∞–¥–∫–∞
                    })
                    .catch(function(error) {
                        console.error("Error logging login: ", error);
                    });
            }, { onlyOnce: true });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        function initializeUserData() {
            var userRef = ref(db, "users/" + userId);
            onValue(userRef, function(snapshot) {
                if (snapshot.exists()) {
                    var data = snapshot.val();
                    serverBalance = data.server_balance || 0;
                    balance = serverBalance;
                    energy = Math.floor(data.energy || maxEnergy); // –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
                    maxEnergy = Math.floor(data.max_energy || 100); // –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
                    rechargeRate = data.recharge_rate || 1;
                    clickPower = data.boosts && data.boosts.multiply_per_click ? Math.max(1, Object.keys(data.boosts.multiply_per_click).length) : 1;
                    passiveIncome.card1 = data.boosts && data.boosts.passive_income && data.boosts.passive_income.card1 ? Object.keys(data.boosts.passive_income.card1).length : 0;
                    passiveIncome.card2 = data.boosts && data.boosts.passive_income && data.boosts.passive_income.card2 ? Object.keys(data.boosts.passive_income.card2).length : 0;
                    passiveIncome.card3 = data.boosts && data.boosts.passive_income && data.boosts.passive_income.card3 ? Object.keys(data.boosts.passive_income.card3).length : 0;
                    // –ü–æ–ª—É—á–µ–Ω–∏–µ firstClickTime
                    if (data.click_balance_history) {
                        var firstKey = Object.keys(data.click_balance_history)[0];
                        firstClickTime = data.click_balance_history[firstKey].t || 0;
                    }
                    console.log("Firebase init: balance=" + balance + ", energy=" + energy + ", clickPower=" + clickPower + ", firstClickTime=" + firstClickTime); // –û—Ç–ª–∞–¥–∫–∞
                    updateUI();
                } else {
                    console.log("No user data, initializing new data"); // –û—Ç–ª–∞–¥–∫–∞
                    saveData();
                    updateUI();
                }
            }, { onlyOnce: true });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
        document.getElementById("click").addEventListener("click", function() {
            var now = Date.now();
            if (now - lastClickTime < MIN_CLICK_INTERVAL) {
                console.log("Click blocked: too frequent"); // –û—Ç–ª–∞–¥–∫–∞
                return;
            }
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –∫–ª–∏–∫–æ–≤
            var secondAgo = now - 1000;
            var recentClicks = clickBuffer.filter(function(click) {
                return click.t > secondAgo;
            });
            if (recentClicks.length >= MAX_CLICKS_PER_SECOND) {
                console.error("Too many clicks: " + recentClicks.length);
                alert("Too many clicks. Please slow down.");
                return;
            }

            lastClickTime = now;
            if (energy >= 1) {
                energy -= 1;
                balance += clickPower;
                serverBalance += clickPower;
                clickBuffer.push({ t: now, b: clickPower });
                console.log("Click buffered: balance=" + balance + ", energy=" + energy + ", bufferSize=" + clickBuffer.length); // –û—Ç–ª–∞–¥–∫–∞
                updateUI();
            } else {
                console.log("Not enough energy: " + energy); // –û—Ç–ª–∞–¥–∫–∞
                alert("Not enough energy!");
            }
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
        setInterval(function() {
            if (clickBuffer.length === 0) return;
            var clicksToSave = clickBuffer.splice(0, clickBuffer.length);
            console.log("Flushing clicks: count=" + clicksToSave.length); // –û—Ç–ª–∞–¥–∫–∞
            clicksToSave.forEach(function(click) {
                var key = click.t;
                var data = firstClickTime === 0 ? { t: click.t, b: click.b } : { delta_t: click.t - firstClickTime, b: click.b };
                if (firstClickTime === 0) firstClickTime = click.t;
                set(ref(db, "users/" + userId + "/click_balance_history/" + key), data)
                    .then(function() {
                        console.log("Click saved: key=" + key + ", data=" + JSON.stringify(data)); // –û—Ç–ª–∞–¥–∫–∞
                    })
                    .catch(function(error) {
                        console.error("Error saving click: ", error);
                    });
            });
            saveData().then(function() {
                updateUI();
            });
        }, BUFFER_FLUSH_INTERVAL);

        // –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(function() {
            var now = Date.now();
            if (now - lastEnergyUpdate < ENERGY_UPDATE_INTERVAL) return;
            if (energy < maxEnergy) {
                var increase = Math.floor(Math.min(rechargeRate, maxEnergy - energy));
                energy += increase;
                lastEnergyUpdate = now;
                console.log("Energy regen: energy=" + energy + ", increase=" + increase); // –û—Ç–ª–∞–¥–∫–∞
                saveData().then(function() {
                    updateUI();
                });
            }
        }, ENERGY_UPDATE_INTERVAL);

        // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
        setInterval(function() {
            var totalPassive = passiveIncome.card1 + passiveIncome.card2 + passiveIncome.card3;
            if (totalPassive > 0) {
                balance += totalPassive;
                serverBalance += totalPassive;
                console.log("Passive income: balance=" + balance + ", totalPassive=" + totalPassive); // –û—Ç–ª–∞–¥–∫–∞
                saveData().then(function() {
                    updateUI();
                });
            }
        }, 1000);

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        async function saveData() {
            if (!userId) return;
            try {
                await set(ref(db, "users/" + userId), {
                    server_balance: serverBalance,
                    energy: energy,
                    max_energy: maxEnergy,
                    recharge_rate: rechargeRate,
                    boosts: {
                        multiply_per_click: buildBoostLevels("multiply_per_click"),
                        energy_limit: buildBoostLevels("energy_limit"),
                        recharge_energy: buildBoostLevels("recharge_energy"),
                        passive_income: {
                            card1: buildBoostLevels("passive_income/card1"),
                            card2: buildBoostLevels("passive_income/card2"),
                            card3: buildBoostLevels("passive_income/card3")
                        }
                    }
                });
                console.log("Data saved: balance=" + serverBalance + ", energy=" + energy); // –û—Ç–ª–∞–¥–∫–∞
            } catch (error) {
                console.error("Error saving data: ", error);
            }
        }

        // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É—Å—Ç–æ–≤ —Å –¥–µ–ª—å—Ç–∞-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        function buildBoostLevels(path) {
            var levels = {};
            var count, firstTime = firstClickTime || Date.now();
            if (path === "multiply_per_click") count = clickPower;
            else if (path === "energy_limit") count = maxEnergy / 100;
            else if (path === "recharge_energy") count = rechargeRate;
            else if (path === "passive_income/card1") count = passiveIncome.card1;
            else if (path === "passive_income/card2") count = passiveIncome.card2;
            else if (path === "passive_income/card3") count = passiveIncome.card3;
            else count = 0;

            for (var i = 1; i <= count; i++) {
                levels[i] = i === 1 ? firstTime : firstTime + (3600000 * i); // –î–µ–ª—å—Ç–∞-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
            }
            return levels;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            document.getElementById("balance").innerText = Math.floor(balance);
            document.getElementById("energy").innerText = "Energy: " + energy + "/" + maxEnergy;
            document.getElementById("energy-fill").style.width = (energy / maxEnergy) * 100 + "%";

            document.querySelector(".level-multiply-per-click").innerText = clickPower;
            document.querySelector(".cost-multiply-per-click").innerText = Math.floor(100 * clickPower * clickPower);
            document.querySelector(".level-energy-limit").innerText = maxEnergy / 100;
            document.querySelector(".cost-energy-limit").innerText = Math.floor(200 * (maxEnergy / 100) * (maxEnergy / 100));
            document.querySelector(".level-recharge-energy").innerText = rechargeRate;
            document.querySelector(".cost-recharge-energy").innerText = Math.floor(150 * rechargeRate * rechargeRate);
            document.querySelector(".level-passive-card1").innerText = passiveIncome.card1;
            document.querySelector(".cost-passive-card1").innerText = Math.floor(300 * (passiveIncome.card1 + 1) * (passiveIncome.card1 + 1));
            document.querySelector(".level-passive-card2").innerText = passiveIncome.card2;
            document.querySelector(".cost-passive-card2").innerText = Math.floor(500 * (passiveIncome.card2 + 1) * (passiveIncome.card2 + 1));
            document.querySelector(".level-passive-card3").innerText = passiveIncome.card3;
            document.querySelector(".cost-passive-card3").innerText = Math.floor(1000 * (passiveIncome.card3 + 1) * (passiveIncome.card3 + 1));
        }


                    // –ü–æ–∫—É–ø–∫–∞ –±—É—Å—Ç–∞
        function buyBoost(type, path, cost, updateFn) {
            console.log("Buy attempt: balance=" + balance + ", cost=" + cost); // –û—Ç–ª–∞–¥–∫–∞
            if (balance >= cost) {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ click_balance_history
                onValue(ref(db, "users/" + userId + "/click_balance_history"), function(snapshot) {
                    var calculatedBalance = 0;
                    if (snapshot.exists()) {
                        var history = snapshot.val();
                        Object.values(history).forEach(function(entry) {
                            calculatedBalance += entry.b;
                        });
                    }
                    if (calculatedBalance < cost) {
                        console.error("Invalid balance: client=" + balance + ", server=" + calculatedBalance);
                        alert("Invalid balance. Please contact support.");
                        return;
                    }
                    balance -= cost;
                    serverBalance -= cost;
                    updateFn();
                    var now = Date.now();
                    var level = getNextLevel(path);
                    var timeValue = firstClickTime === 0 ? now : now - firstClickTime;
                    if (firstClickTime === 0) firstClickTime = now;
                    set(ref(db, "users/" + userId + "/boosts/" + path + "/" + level), timeValue)
                        .then(function() {
                            console.log("Boost purchased: type=" + type + ", level=" + level + ", cost=" + cost + ", time=" + timeValue); // –û—Ç–ª–∞–¥–∫–∞
                            saveData().then(function() {
                                updateUI();
                            });
                        })
                        .catch(function(error) {
                            console.error("Error saving boost " + type + ": ", error);
                        });
                }, { onlyOnce: true });
            } else {
                console.log("Not enough coins: balance=" + balance + ", cost=" + cost); // –û—Ç–ª–∞–¥–∫–∞
                alert("Not enough coins!");
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –±—É—Å—Ç–∞
        function getNextLevel(path) {
            if (path === "multiply_per_click") return clickPower + 1;
            if (path === "energy_limit") return maxEnergy / 100 + 1;
            if (path === "recharge_energy") return rechargeRate + 1;
            if (path === "passive_income/card1") return passiveIncome.card1 + 1;
            if (path === "passive_income/card2") return passiveIncome.card2 + 1;
            if (path === "passive_income/card3") return passiveIncome.card3 + 1;
            return 1;
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–Ω–æ–ø–æ–∫ –±—É—Å—Ç–æ–≤
        document.querySelector(".boost-multiply-per-click").addEventListener("click", function() {
            var cost = Math.floor(100 * clickPower * clickPower);
            buyBoost("multiply_per_click", "multiply_per_click", cost, function() { clickPower += 1; });
        });
        document.querySelector(".boost-energy-limit").addEventListener("click", function() {
            var cost = Math.floor(200 * (maxEnergy / 100) * (maxEnergy / 100));
            buyBoost("energy_limit", "energy_limit", cost, function() { maxEnergy += 100; });
        });
        document.querySelector(".boost-recharge-energy").addEventListener("click", function() {
            var cost = Math.floor(150 * rechargeRate * rechargeRate);
            buyBoost("recharge_energy", "recharge_energy", cost, function() { rechargeRate += 0.5; });
        });
        document.querySelector(".boost-passive-card1").addEventListener("click", function() {
            var cost = Math.floor(300 * (passiveIncome.card1 + 1) * (passiveIncome.card1 + 1));
            buyBoost("passive_income/card1", "passive_income/card1", cost, function() { passiveIncome.card1 += 1; });
        });
        document.querySelector(".boost-passive-card2").addEventListener("click", function() {
            var cost = Math.floor(500 * (passiveIncome.card2 + 1) * (passiveIncome.card2 + 1));
            buyBoost("passive_income/card2", "passive_income/card2", cost, function() { passiveIncome.card2 += 2; });
        });
        document.querySelector(".boost-passive-card3").addEventListener("click", function() {
            var cost = Math.floor(1000 * (passiveIncome.card3 + 1) * (passiveIncome.card3 + 1));
            buyBoost("passive_income/card3", "passive_income/card3", cost, function() { passiveIncome.card3 += 5; });
        });

        // –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞
        document.querySelector(".invite-friend").addEventListener("click", function() {
            try {
                var inviteLink = "https://t.me/your_bot?start=" + encodeURIComponent(userId);
                var shareUrl = "https://t.me/share/url?url=" + encodeURIComponent(inviteLink) + "&text=" + encodeURIComponent("Join my game!");
                tg.openTelegramLink(shareUrl);
            } catch (error) {
                console.error("Error generating invite link: ", error);
                alert("Failed to generate invite link. Please try again.");
            }
        });

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
        document.querySelectorAll(".tab").forEach(function(tab) {
            tab.addEventListener("click", function() {
                var tabIndex = parseInt(tab.getAttribute("data-tab"));
                document.querySelectorAll(".content").forEach(function(content, index) {
                    content.style.display = index === tabIndex - 1 ? "block" : "none";
                });
                document.querySelectorAll(".tab").forEach(function(t, index) {
                    t.classList.toggle("active", index === tabIndex - 1);
                });
            });
        });
    </script>
</body>
</html>
